ylab("Relative number of medals") +
labs(caption = paste(url1, url2, sep = "\n")) +
theme(axis.title.x = element_blank()) +
labs(subtitle = paste("Date:", Sys.time())) +
theme(legend.justification = c(1, 1), legend.position = c(1, 1)) +
scale_fill_gradient(low = "blue", high = "red") +
geom_text(aes(y = 0, label = population), angle = 90, hjust = 0, size = 3, color = "gray")
p <- cowplot::plot_grid(p1, p2, ncol = 1, align = "hv")
cowplot::save_plot(
"/home/persican/Desktop/olympic.pdf",
p,
base_height = 10,
base_width = 9
)
embed_fonts("/home/persican/Desktop/olympic.pdf")
p2 <- res2 %>%
ggplot(aes(x = reorder(country, -normalized_count), y = normalized_count)) +
geom_bar(stat = "identity") +
# geom_flag(aes(country = code), size = 5) +
theme_bw(base_family = "Open Sans") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 7, vjust = 0.5)) +
xlab("Country") +
ylab("Relative number of medals") +
labs(caption = paste(url1, url2, sep = "\n")) +
theme(axis.title.x = element_blank()) +
labs(subtitle = paste("Date:", Sys.time())) +
theme(legend.justification = c(1, 1), legend.position = c(1, 1)) +
scale_fill_gradient(low = "blue", high = "red") +
geom_text(aes(y = 0, label = population), angle = 90, hjust = 0, size = 2, color = "gray")
p <- cowplot::plot_grid(p1, p2, ncol = 1, align = "hv")
cowplot::save_plot(
"/home/persican/Desktop/olympic.pdf",
p,
base_height = 10,
base_width = 9
)
source('/media/persican/Philippe Massicotte/Phil/Dropbox/JO.R', echo=TRUE)
p2 <- res2 %>%
ggplot(aes(x = reorder(country, -normalized_count), y = normalized_count)) +
geom_bar(stat = "identity") +
# geom_flag(aes(country = code), size = 5) +
theme_bw(base_family = "Open Sans") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 7, vjust = 0.5)) +
xlab("Country") +
ylab("Relative number of medals") +
labs(caption = paste(url1, url2, sep = "\n")) +
theme(axis.title.x = element_blank()) +
labs(subtitle = paste("Date:", Sys.time())) +
theme(legend.justification = c(1, 1), legend.position = c(1, 1)) +
scale_fill_gradient(low = "blue", high = "red") +
geom_text(aes(label = population), angle = 90, hjust = 0, size = 2, color = "gray")
p <- cowplot::plot_grid(p1, p2, ncol = 1, align = "hv")
cowplot::save_plot(
"/home/persican/Desktop/olympic.pdf",
p,
base_height = 10,
base_width = 9
)
embed_fonts("/home/persican/Desktop/olympic.pdf")
p2 <- res2 %>%
ggplot(aes(x = reorder(country, -normalized_count), y = normalized_count)) +
geom_bar(stat = "identity") +
# geom_flag(aes(country = code), size = 5) +
theme_bw(base_family = "Open Sans") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 7, vjust = 0.5)) +
xlab("Country") +
ylab("Relative number of medals") +
labs(caption = paste(url1, url2, sep = "\n")) +
theme(axis.title.x = element_blank()) +
labs(subtitle = paste("Date:", Sys.time())) +
theme(legend.justification = c(1, 1), legend.position = c(1, 1)) +
scale_fill_gradient(low = "blue", high = "red") +
geom_text(aes(label = population), angle = 90, hjust = 0, size = 2)
p <- cowplot::plot_grid(p1, p2, ncol = 1, align = "hv")
cowplot::save_plot(
"/home/persican/Desktop/olympic.pdf",
p,
base_height = 10,
base_width = 9
)
embed_fonts("/home/persican/Desktop/olympic.pdf")
format(round(as.numeric(1000.64), 1), nsmall=1, big.mark=",")
format(round(as.numeric(100064), 1), nsmall=1, big.mark=",")
format(round(as.numeric(100064), 1), nsmall=0, big.mark=",")
p2 <- res2 %>%
ggplot(aes(x = reorder(country, -normalized_count), y = normalized_count)) +
geom_bar(stat = "identity") +
# geom_flag(aes(country = code), size = 5) +
theme_bw(base_family = "Open Sans") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 7, vjust = 0.5)) +
xlab("Country") +
ylab("Relative number of medals") +
labs(caption = paste(url1, url2, sep = "\n")) +
theme(axis.title.x = element_blank()) +
labs(subtitle = paste("Date:", Sys.time())) +
theme(legend.justification = c(1, 1), legend.position = c(1, 1)) +
scale_fill_gradient(low = "blue", high = "red") +
geom_text(aes(label = format(population, big.mark = ","), angle = 90, hjust = 0, size = 2)
p <- cowplot::plot_grid(p1, p2, ncol = 1, align = "hv")
cowplot::save_plot(
"/home/persican/Desktop/olympic.pdf",
p,
base_height = 10,
base_width = 9
)
p2 <- res2 %>%
ggplot(aes(x = reorder(country, -normalized_count), y = normalized_count)) +
geom_bar(stat = "identity") +
# geom_flag(aes(country = code), size = 5) +
theme_bw(base_family = "Open Sans") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 7, vjust = 0.5)) +
xlab("Country") +
ylab("Relative number of medals") +
labs(caption = paste(url1, url2, sep = "\n")) +
theme(axis.title.x = element_blank()) +
labs(subtitle = paste("Date:", Sys.time())) +
theme(legend.justification = c(1, 1), legend.position = c(1, 1)) +
scale_fill_gradient(low = "blue", high = "red") +
geom_text(aes(label = format(population, big.mark = ",")), angle = 90, hjust = 0, size = 2)
p <- cowplot::plot_grid(p1, p2, ncol = 1, align = "hv")
cowplot::save_plot(
"/home/persican/Desktop/olympic.pdf",
p,
base_height = 10,
base_width = 9
)
embed_fonts("/home/persican/Desktop/olympic.pdf")
p2 <- res2 %>%
ggplot(aes(x = reorder(country, -normalized_count), y = normalized_count)) +
geom_bar(stat = "identity") +
# geom_flag(aes(country = code), size = 5) +
theme_bw(base_family = "Open Sans") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 7, vjust = 0.5)) +
xlab("Country") +
ylab("Relative number of medals") +
labs(caption = paste(url1, url2, sep = "\n")) +
theme(axis.title.x = element_blank()) +
labs(subtitle = paste("Date:", Sys.time())) +
theme(legend.justification = c(1, 1), legend.position = c(1, 1)) +
scale_fill_gradient(low = "blue", high = "red") +
geom_text(aes(label = format(population, big.mark = ",")), angle = 90, hjust = 0, size = 1)
p <- cowplot::plot_grid(p1, p2, ncol = 1, align = "hv")
cowplot::save_plot(
"/home/persican/Desktop/olympic.pdf",
p,
base_height = 10,
base_width = 9
)
embed_fonts("/home/persican/Desktop/olympic.pdf")
p2 <- res2 %>%
ggplot(aes(x = reorder(country, -normalized_count), y = normalized_count)) +
geom_bar(stat = "identity") +
# geom_flag(aes(country = code), size = 5) +
theme_bw(base_family = "Open Sans") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 7, vjust = 0.5)) +
xlab("Country") +
ylab("Relative number of medals") +
labs(caption = paste(url1, url2, sep = "\n")) +
theme(axis.title.x = element_blank()) +
labs(subtitle = paste("Date:", Sys.time())) +
theme(legend.justification = c(1, 1), legend.position = c(1, 1)) +
scale_fill_gradient(low = "blue", high = "red") +
geom_text(aes(label = format(population, big.mark = ",")), angle = 90, hjust = 0, size = 1.5)
p <- cowplot::plot_grid(p1, p2, ncol = 1, align = "hv")
cowplot::save_plot(
"/home/persican/Desktop/olympic.pdf",
p,
base_height = 10,
base_width = 9
)
embed_fonts("/home/persican/Desktop/olympic.pdf")
source('/media/persican/Philippe Massicotte/Phil/Dropbox/JO.R', echo=TRUE)
library(rworldmap)
data(countryExData)
countryExData
data(countryExData)
joinCountryData2Map(countryExData+,
joinCode = "ISO3"+,
nameJoinColumn = "ISO3V10")
joinCountryData2Map(countryExData,
joinCode = "ISO3",
nameJoinColumn = "ISO3V10")
rm(list = ls())
graphics.off()
# devtools::install_github("baptiste/ggflags")
library(rvest)
library(dplyr)
library(ggplot2)
library(ggflags)
library(extrafont)
library(tidyr)
loadfonts(quiet = TRUE)
# Get meals information ---------------------------------------------------
url1 <- "http://www.nbcolympics.com/medals"
medals <- read_html(url1) %>%
html_nodes("table") %>%
.[[1]] %>%
html_table() %>%
mutate(code = countrycode::countrycode(Country, "country.name", "iso2c")) %>%
mutate(code = tolower(code)) %>%
gather(medal_color, count, Gold, Silver, Bronze) %>%
arrange(Total) %>%
mutate(medal_color = factor(medal_color, levels = c("Gold", "Silver", "Bronze"))) %>%
rename(country = Country) %>%
drop_na(country, code) %>%
mutate(rank = rank(-Total))
# Get country population --------------------------------------------------
url2 <- "http://www.worldometers.info/world-population/population-by-country/"
world_population <- read_html(url2) %>%
html_nodes("table") %>%
.[[1]] %>%
html_table() %>%
select(
country = `Country (or dependency)`,
population = `Population(2016)`,
Med.Age
) %>%
mutate(code = countrycode::countrycode(country, "country.name", "iso2c")) %>%
mutate(population = readr::parse_number(population)) %>%
mutate(Med.Age = readr::parse_number(Med.Age)) %>%
mutate(code = tolower(code)) %>%
drop_na(country, population, code)
# Merge -------------------------------------------------------------------
res2 <- medals %>%
group_by(code) %>%
summarise(total = sum(count)) %>%
left_join(world_population, by = "code") %>%
mutate(normalized_count = total / population)
# Plot --------------------------------------------------------------------
p1 <- medals %>%
ggplot(aes(x = reorder(country, -Total), y = count)) +
geom_bar(stat = "identity", aes(fill = medal_color)) +
# geom_flag(aes(country = code), size = 5) +
theme_bw(base_family = "Open Sans") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 7, vjust = 0.5)) +
scale_fill_manual(
values = c(
"Gold" = "gold",
"Bronze" = "#cd7f32",
"Silver" = "#C0C0C0"
)
) +
xlab("Country") +
ylab("Total number of medals") +
theme(legend.justification = c(1, 1), legend.position = c(1, 1)) +
theme(legend.title = element_blank()) +
theme(axis.title.x = element_blank())
p2 <- res2 %>%
ggplot(aes(x = reorder(country, -normalized_count), y = normalized_count)) +
geom_bar(stat = "identity") +
# geom_flag(aes(country = code), size = 5) +
theme_bw(base_family = "Open Sans") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 7, vjust = 0.5)) +
xlab("Country") +
ylab("Relative number of medals") +
labs(caption = paste(url1, url2, sep = "\n")) +
theme(axis.title.x = element_blank()) +
labs(subtitle = paste("Date:", Sys.time())) +
theme(legend.justification = c(1, 1), legend.position = c(1, 1)) +
scale_fill_gradient(low = "blue", high = "red") +
geom_text(aes(label = format(population, big.mark = " ")), angle = 90, hjust = 0, size = 1.5)
p <- cowplot::plot_grid(p1, p2, ncol = 1, align = "hv")
cowplot::save_plot(
"/home/persican/Desktop/olympic.pdf",
p,
base_height = 10,
base_width = 9
)
embed_fonts("/home/persican/Desktop/olympic.pdf")
library(rworldmap)
res2
data(countryExData)
joinCountryData2Map(res2,
joinCode = "ISO2",
nameJoinColumn = "code")
joinCountryData2Map(res2,
joinCode = "ISO2",
nameJoinColumn = "code",
nameCountryColumn = "country")
res2 %>%
mutate(code = toupper(code)) %>%
joinCountryData2Map(joinCode = "ISO2",
nameJoinColumn = "code",
nameCountryColumn = "country")
tt <- res2 %>%
mutate(code = toupper(code)) %>%
joinCountryData2Map(joinCode = "ISO2",
nameJoinColumn = "code",
nameCountryColumn = "country")
tt
mapCountryData(sPDF, nameColumnToPlot = "count")
mapCountryData(tt, nameColumnToPlot = "count")
names(tt)
mapCountryData(tt, nameColumnToPlot = "total")
mapCountryData(tt, nameColumnToPlot = "total", catMethod = 3)
tt <- res2 %>%
mutate(code = toupper(code)) %>%
joinCountryData2Map(joinCode = "ISO2",
nameJoinColumn = "code",
nameCountryColumn = "country") %>%
fortify()
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon()
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total))
names(tt)
tt <- res2 %>%
mutate(code = toupper(code)) %>%
joinCountryData2Map(joinCode = "ISO2",
nameJoinColumn = "code",
nameCountryColumn = "country") %>%
fortify(res)
tt <- res2 %>%
mutate(code = toupper(code)) %>%
joinCountryData2Map(joinCode = "ISO2",
nameJoinColumn = "code",
nameCountryColumn = "country") %>%
fortify(res2)
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total))
names(tt)
left_join(tt, res2)
left_join(tt, res2, by = c("id" = "code"))
tt <- left_join(tt, res2, by = c("id" = "code"))
names(tt)
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total))
View(tt)
tt <- res2 %>%
mutate(code = toupper(code)) %>%
joinCountryData2Map(joinCode = "ISO2",
nameJoinColumn = "code",
nameCountryColumn = "country") %>%
fortify(res2)
tt <- left_join(tt, res2, by = c("id" = "group"))
names(tt)
tt$group
tt$id
tt <- left_join(tt, res2, by = c("id" = "country"))
names(tt)
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total))
getMap(resolution = "coarse")
m <- getMap(resolution = "coarse")
m <- getMap(resolution = "coarse") %>%
fortify()
m
names(m)
tt <- res2 %>%
left_join(m, by = c("id" = "country"))
names(res2)
tt <- res2 %>%
left_join(m, by = c("country" = "id"))
names(tt)
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total))
m <- getMap(resolution = "high") %>%
fortify()
tt <- res2 %>%
left_join(m, by = c("country" = "id"))
names(tt)
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total))
names(m)
head(m)
View(m)
unique(res2$country)
medals
unique(medals$country)
m <- getMap(resolution = "coarse") %>%
fortify() %>%
mutate(code = countrycode::countrycode(country, "country.name", "iso2c"))
names(m)
m <- getMap(resolution = "coarse") %>%
fortify() %>%
mutate(code = countrycode::countrycode(group, "country.name", "iso2c"))
m
tt <- res2 %>%
left_join(m, by = c("code" = "code"))
names(tt)
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total))
tt
m <- getMap(resolution = "coarse") %>%
fortify() %>%
mutate(code = countrycode::countrycode(group, "country.name", "iso2c"))
tt <- res2 %>%
left_join(m)
names(tt)
View(tt)
m
View(m)
m <- getMap(resolution = "coarse") %>%
fortify() %>%
mutate(code = tolower(countrycode::countrycode(group, "country.name", "iso2c")))
m <- getMap(resolution = "coarse") %>%
fortify() %>%
mutate(code = toupper(countrycode::countrycode(group, "country.name", "iso2c")))
tt <- res2 %>%
left_join(m)
names(tt)
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total))
View(tt)
m <- getMap(resolution = "coarse") %>%
fortify() %>%
mutate(code = toupper(countrycode::countrycode(group, "country.name", "iso2c")))
res2
m <- getMap(resolution = "coarse") %>%
fortify() %>%
mutate(code = tolower(countrycode::countrycode(group, "country.name", "iso2c")))
tt <- res2 %>%
left_join(m)
names(tt)
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total))
m <- getMap(resolution = "fine") %>%
fortify() %>%
mutate(code = tolower(countrycode::countrycode(group, "country.name", "iso2c")))
tt <- res2 %>%
left_join(m)
m <- getMap(resolution = "high") %>%
fortify() %>%
mutate(code = tolower(countrycode::countrycode(group, "country.name", "iso2c")))
tt <- res2 %>%
left_join(m)
names(tt)
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total))
tt
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total), drop= FALSE)
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon()
tt <- res2 %>%
full_join(m)
names(tt)
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon()
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total))
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total)) +
scale_fill_gradientn(jet.colors)
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total)) +
scale_fill_gradientn(jet.colors(255))
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total)) +
scale_fill_gradientn(colors = jet.colors(255))
jet.colors <-
colorRampPalette(
c(
"#00007F",
"blue",
"#007FFF",
"cyan",
"#7FFF7F",
"yellow",
"#FF7F00",
"red",
"#7F0000"
)
)
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total)) +
scale_fill_gradientn(colors = jet.colors(255))
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total)) +
scale_fill_gradientn(colors = jet.colors(255)) +
theme_bw()
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total)) +
scale_fill_brewer() +
theme_bw()
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total)) +
scale_fill_brewer(palette = "Set1") +
theme_bw()
tt %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total)) +
scale_fill_gradient2() +
theme_bw()
ggsave("/home/persican/Desktop/map.pdf")
vignette(topic = "introduction", package = "eemR")
source('/media/persican/Philippe Massicotte/Phil/blog/rmd_to_jekyll.R', echo=TRUE)
KnitPost()
KnitPost()
install.packages(c("feather", "RcppArmadillo"))
